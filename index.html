<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quran Words with Surah and Ayah</title>
  <style>
    body {
      font-family: 'Tahoma', 'Arial', sans-serif;
      background-color: #f4f4f9;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #333;
    }
    .verse-container {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      padding: 20px;
    }
    .verse-item {
      background-color: #4CAF50;
      color: white;
      padding: 10px;
      border-radius: 5px;
      font-size: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    .word {
      display: inline-block;
      padding: 5px;
      background-color: #f0ad4e;
      color: white;
      border-radius: 3px;
      cursor: pointer;
      font-size: 16px;
      margin: 2px;
    }
    .word:hover {
      background-color: #d9534f;
    }
    .popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 18px;
    }
    .popup-content {
      background: #333;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }
    .close-btn {
      background: red;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    .close-btn:hover {
      background: darkred;
    }
  </style>
</head>
<body>
  <h1>Quranic Verses</h1>
  <div id="verseContainer" class="verse-container"></div>

  <!-- Popup for translation -->
  <div id="popup" class="popup">
    <div class="popup-content">
      <p id="wordTranslation">Loading...</p>
      <button id="closePopup" class="close-btn">Close</button>
    </div>
  </div>

  <script>
    async function loadQuranData() {
      try {
        // Fetch the words data (indopak-qurancom.json)
        const wordsResponse = await fetch('https://raw.githubusercontent.com/itzfew/Qurank/refs/heads/main/source/indopak-qurancom.json');
        const wordsData = await wordsResponse.json();

        // Fetch the verse metadata (word.json)
        const metadataResponse = await fetch('https://raw.githubusercontent.com/itzfew/Qurank/refs/heads/main/source/word.json');
        const metadataData = await metadataResponse.json();

        // Fetch the translation data (en-qurancom.json)
        const translationResponse = await fetch('https://raw.githubusercontent.com/itzfew/Qurank/refs/heads/main/source/en-qurancom.json');
        const translationData = await translationResponse.json();

        // Get the container to display the verses
        const container = document.getElementById('verseContainer');

        // Combine the word data with the verse metadata
        const verses = {};

        // Loop through each word data and organize them into verses
        for (const key in wordsData) {
          if (wordsData.hasOwnProperty(key) && metadataData.hasOwnProperty(key)) {
            const word = wordsData[key];
            const metadata = metadataData[key];

            // Get Surah and Ayah
            const surah = metadata.surah;
            const ayah = metadata.ayah;
            const position = metadata.position;

            // Initialize verse if not already created
            const verseKey = `${surah}:${ayah}`;
            if (!verses[verseKey]) {
              verses[verseKey] = {
                surah: surah,
                ayah: ayah,
                words: [],
              };
            }

            // Add the word to the verse's words array
            verses[verseKey].words[position] = word;  // This maintains the order of words
          }
        }

        // Now that we have organized the words in verses, let's display them
        for (const verseKey in verses) {
          const verse = verses[verseKey];
          const verseElement = document.createElement('div');
          verseElement.classList.add('verse-item');
          
          // Verse Header (Surah and Ayah)
          const verseHeader = document.createElement('div');
          verseHeader.classList.add('verse-header');
          verseHeader.textContent = `Surah ${verse.surah}, Ayah ${verse.ayah}`;
          verseElement.appendChild(verseHeader);

          // Combine the words and make them clickable
          const verseWordsContainer = document.createElement('div');
          verse.words.forEach((word, index) => {
            const wordElement = document.createElement('span');
            wordElement.classList.add('word');
            wordElement.textContent = word;
            wordElement.setAttribute('data-index', index);

            // Add click event listener to fetch translation
            wordElement.addEventListener('click', () => showTranslation(word, index, translationData));

            verseWordsContainer.appendChild(wordElement);
          });
          verseElement.appendChild(verseWordsContainer);

          // Append the verse item to the container
          container.appendChild(verseElement);
        }

      } catch (error) {
        console.error('Error fetching the data:', error);
      }
    }

    // Function to show translation in popup
    function showTranslation(word, index, translationData) {
      const translation = translationData[index + 1];  // Adjust index as the translation JSON is 1-based
      const popup = document.getElementById('popup');
      const wordTranslation = document.getElementById('wordTranslation');
      
      // Set the translation text in the popup
      wordTranslation.textContent = `Translation of "${word}": ${translation}`;

      // Display the popup
      popup.style.display = 'flex';
    }

    // Close popup when clicking close button
    document.getElementById('closePopup').addEventListener('click', () => {
      document.getElementById('popup').style.display = 'none';
    });

    // Load Quran data when the page is ready
    loadQuranData();
  </script>
</body>
</html>
